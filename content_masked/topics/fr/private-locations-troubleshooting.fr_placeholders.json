{
  "[URL_BASE_TOPICS]": "/support/kb/",
  "[FRONTMATTER_TRANSLATIONKEY]": "https://www.uptrends.com/support/kb/synthetic-monitoring/checkpoints/private-locations/private-locations-troubleshooting",
  "[LINK_URL_1]": "#verify-private-location-installation",
  "[LINK_URL_2]": "#smoke-test-your-setup",
  "[LINK_URL_3]": "#how-to-troubleshoot",
  "[LINK_URL_4]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/install-docker-private-checkpoints#installation-steps\" lang=\"fr\" >}}",
  "[LINK_URL_5]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/install-docker-private-checkpoints#installation-script\" lang=\"fr\" >}}",
  "[LINK_URL_6]": "#managing-running-containers",
  "[LINK_URL_7]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/private-checkpoints-update-containers\" lang=\"fr\" >}}",
  "[LINK_URL_8]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/private-locations-data-protection\" lang=\"fr\" >}}",
  "[LINK_URL_9]": "#dns-issues",
  "[LINK_URL_10]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/private-locations-how-to-use#disable-a-private-checkpoint\" lang=\"fr\" >}}",
  "[LINK_URL_11]": "{{< ref path=\"support/kb/synthetic-monitoring/checkpoints/private-locations/private-locations-checkpoint-health\" lang=\"fr\" >}}",
  "[LINK_URL_12]": "{{< ref path=\"/support/kb/synthetic-monitoring/checkpoints/private-locations/install-docker-private-checkpoints\" lang=\"fr\" >}}",
  "[LINK_URL_13]": "https://docs.docker.com/engine/manage-resources/pruning",
  "[LINK_URL_14]": "{{< ref path=\"contact\" lang=\"fr\" >}}",
  "[SHORTCODE_1]": "{{< callout >}}",
  "[SHORTCODE_2]": "{{< /callout >}}",
  "[SHORTCODE_3]": "{{< callout >}}",
  "[SHORTCODE_4]": "{{< /callout >}}",
  "[SHORTCODE_5]": "{{< AppElement type=\"buttonSecondary\" >}}",
  "[SHORTCODE_6]": "{{< /AppElement >}}",
  "[SHORTCODE_7]": "{{< AppElement type=\"buttonSecondary\" >}}",
  "[SHORTCODE_8]": "{{< /AppElement >}}",
  "[CODE_BLOCK_1]": "```Docker exec -i checkpoint powershell```",
  "[CODE_BLOCK_2]": "```Docker exec -i checkpoint cmd```",
  "[CODE_BLOCK_3]": "```winver : The term 'winver' is not recognized```",
  "[CODE_BLOCK_4]": "```yaml\nTransactionProcessor:\n    container_name: TransactionProcessor\n    image: uptrends.azurecr.io/win2022/transaction-processor\n    deploy:\n      restart_policy:\n        condition: always\n    volumes:\n      - .\\Certificates:C:\\Uptrends\\Certificates:ro\n    logging:\n      driver: local\n    environment:\n      - ServerId=\n      - Password=\n    dns:\n      - 1.2.3.4\n      - 2.3.4.5\n```",
  "[INLINE_CODE_1]": "`Get-WindowsFeature | Where-Object {$_. installstate -eq \"installed\"}`",
  "[INLINE_CODE_2]": "`.\n3. Vérifiez si cette liste contient l'entrée \"Containers\".\n\nEnsuite, vérifiez la sortie concernant la version de Docker.\n1. Ouvrez une console PowerShell en mode admin.\n2. Ouvrez le dossier où se trouve le fichier docker-compose.yml file et exécutez la commande suivante `",
  "[INLINE_CODE_3]": "`Docker -v`",
  "[INLINE_CODE_4]": "`.\n3. Le résultat doit indiquer \"Docker version 23.0.3, build 3e7cbfd\".\n\nPour terminer, vérifiez la sortie concernant la version de Docker Compose.\n1. Ouvrez une console PowerShell en mode admin.\n2. Ouvrez le dossier où se trouve le fichier docker-compose.yml file et exécutez la commande suivante `",
  "[INLINE_CODE_5]": "`Docker-compose -v`",
  "[INLINE_CODE_6]": "`.\n3. Le résultat doit indiquer \"Docker Compose version v2.17.2\".\n\nSi quelque chose vous semble anormal, vous pouvez vous référer au script d'installation, install-checkpoint.ps1, et exécuter manuellement les parties correspondant aux composants ci-dessus, puis examiner la sortie.\n\n### Images de conteneurs\nSi les trois prérequis ci-dessus sont en place, le [script d'installation]([LINK_URL_5]) lancera l'extraction des images de conteneurs d'Uptrends depuis Azure. Ces images sont volumineuses car chacune comprend une installation compressée de Windows Server. Selon le débit du réseau, le téléchargement peut prendre au moins quelques minutes (et dure couramment 20 minutes). Les téléchargements sont plus rapides lors des actualisations ultérieures car des parties des images sont réutilisées. Une fois le téléchargement effectué, vous pouvez procéder à une vérification en [exécutant]([LINK_URL_6]) : `",
  "[INLINE_CODE_7]": "`docker images`",
  "[INLINE_CODE_8]": "`. Trois entrées doivent s'afficher.\n\nL'extraction des images sollicite le fonctionnement interne de Docker. Il s'agit d'un processus robuste qui peut entraîner des défaillances dans les connexions. Si le téléchargement échoue complètement, la cause la plus probable est qu'un pare-feu (local) empêche Docker d'accéder au référentiel de conteneurs Azure via le site azurecr.io, hébergé par Microsoft.\n\nPour réaliser l'authentification lors de l'extraction des images, le script d'installation enregistrera les identifiants via la connexion Docker. En cas de problèmes d'authentification, vous pouvez naviguer jusqu'au répertoire d'installation (le dossier qui contient le script install-checkpoint.ps1) et exécuter ces commandes dans PowerShell pour :\n\nEffacer les identifiants existants :\n`",
  "[INLINE_CODE_9]": "`Docker logout`",
  "[INLINE_CODE_10]": "`\n\nRéexécuter registry-login.ps1 et examiner la sortie de la commande :\n`",
  "[INLINE_CODE_11]": "`.\\registry-login.ps1`",
  "[INLINE_CODE_12]": "`\n\n### Auto-exécution et auto-actualisation\nPour assurer le fonctionnement continu des checkpoints en conteneurs, une tâche planifiée est créée afin d'exécuter le script start-containers.ps1 après le lancement du serveur. Pour [actualiser]([LINK_URL_7]) les images Docker de conteneurs d'Uptrends, une seconde tâche planifiée est créée afin de vérifier régulièrement si des images doivent être actualisées. Reportez-vous à la sortie de la commande PowerShell `",
  "[INLINE_CODE_13]": "`Get-ScheduledTask`",
  "[INLINE_CODE_14]": "` pour vérifier si ces tâches existent. Ces tâches sont nommées \"Start Checkpoint Containers\" et \"Update Checkpoint Images\".\n\nVous pouvez utiliser l'interface utilisateur du Planificateur de tâches de Windows pour examiner les tâches, parcourir l'historique et les défaillances ou activer manuellement la tâche pour résoudre le problème. Comme précédemment, en cas de problème, utilisez le script d'installation (install-checkpoint.ps1) pour réexécuter manuellement cette partie de l'installation.\n\n### Configuration\nToute la configuration relative aux serveurs se trouve dans le fichier de configuration Docker-compose.yml. Ce fichier répertorie les trois images de conteneurs et leurs paramètres individuels. Lors du téléchargement, il est prérempli avec tous les paramètres nécessaires. Une information particulièrement importante : la combinaison `",
  "[INLINE_CODE_15]": "`ServerId/Password`",
  "[INLINE_CODE_16]": "` doit être configurée pour les trois images de conteneurs répertoriées dans le fichier (la même combinaison d'identifiants est répétée trois fois dans le fichier yml, avec les mêmes valeurs).\n\n[SHORTCODE_1] Les valeurs *ServerId* et *Password* sont spécifiques à chaque checkpoint en conteneurs. Les différents serveurs de checkpoints en conteneurs ne peuvent jamais avoir le même *ServerId*.\n[SHORTCODE_2]\n\nLe fichier Docker Compose peut être utilisé pour configurer des politiques de [protection de données]([LINK_URL_8]) spécifiques à un checkpoint, et des [règles DNS propres à l'environnement]([LINK_URL_9]).\n\n### État actuel\nLes conteneurs des trois images se lancent après l'installation et doivent fonctionner de façon continue. Vous pouvez consulter leur état avec la commande `",
  "[INLINE_CODE_17]": "`docker ps`",
  "[INLINE_CODE_18]": "` et vérifier dans la colonne la plus à droite si les conteneurs fonctionnent bien. En cas de problème, utilisez les commandes ci-dessous pour affiner le diagnostic au moyen des fichiers journaux :\n\n\n- Obtenir l'état actuel de tous les conteneurs\n   `",
  "[INLINE_CODE_19]": "`Docker ps`",
  "[INLINE_CODE_20]": "`\n\n- Obtenir les fichiers journaux pour le conteneur de l'agent de checkpoints et les enregistrer dans un fichier texte\n   `",
  "[INLINE_CODE_21]": "`Docker logs Checkpoint | Out-File Docker_CS.txt`",
  "[INLINE_CODE_22]": "`\n\n- Obtenir les fichiers journaux pour le conteneur de traitement des transactions et les enregistrer dans un fichier texte\n   `",
  "[INLINE_CODE_23]": "`Docker logs Checkpoint | Out-File Docker_CS.txt`",
  "[INLINE_CODE_24]": "`\n\n- Obtenir les fichiers journaux combinés pour tous les conteneurs\n   `",
  "[INLINE_CODE_25]": "`Docker-compose logs -t -n 5000 | Out-File Docker.txt`",
  "[INLINE_CODE_26]": "`\n\n## Réaliser un test de fumée de votre configuration\n\nUne fois que les checkpoints en conteneurs sont installés, ils sont immédiatement disponibles pour effectuer des mesures. Les processus internes d'Uptrends modifient automatiquement l'état de maintenance d'un checkpoint en conteneurs, selon son état. Un checkpoint en bon état de fonctionnement est marqué comme actif, tandis qu'un checkpoint présentant un problème est marqué comme étant en maintenance.\n\nL'état des checkpoints est actualisé toutes les minutes. Vous pouvez aussi activer ou [désactiver]([LINK_URL_10]) des checkpoints (par exemple, lors d'une opération de maintenance ou d'un test de configuration) depuis l'interface des emplacements privés dans l'application web d'Uptrends. Par défaut, leur état est \"activé\".\n\nPour réaliser un test de fumée sur un checkpoint en conteneurs, la méthode la plus pratique consiste à utiliser le bouton [SHORTCODE_5] Tester maintenant [SHORTCODE_6]. Idéalement, le test doit être effectué pour chaque type de moniteur que vous souhaitez exécuter au moyen de ce checkpoint.\n\nVous pouvez utiliser l'onglet [Santé du point de contrôle]([LINK_URL_11]) des emplacements privés pour établir un diagnostic sur les checkpoints présentant un problème.\n\nÀ noter que toutes les mesures sont effectuées \"à l'intérieur\" du conteneur. Aucun navigateur n'est lancé sur la machine hôte lorsque vous utilisez le bouton [SHORTCODE_7] Tester maintenant [SHORTCODE_8] pour un moniteur FPC ou un moniteur de transaction.\n\nNotez également que lorsque vous ajoutez un checkpoint à un emplacement privé existant faisant partie de la sélection de checkpoints des moniteurs actifs, le nouveau checkpoint commence à effectuer les mesures une fois l'installation terminée. Si ce n'est pas souhaité (par exemple, si vous préférez le tester d'abord), vous devez désactiver le checkpoint dans la section des emplacements privés d'Uptrends.\n\n\n## Résoudre les problèmes\n\n### Interrompre, démarrer ou redémarrer un ensemble de conteneurs\nRedémarrez les conteneurs associés au fichier Docker-compose.yaml dans le répertoire actuel. Il s'agit souvent du dossier C:\\uptrends\\ :\n\n1. Ouvrez une console PowerShell en mode admin.\n2. Ouvrez le dossier où se trouve le fichier docker-compose.yml file et exécutez une ou plusieurs des commandes suivantes.\n- Pour démarrer le contenu, saisissez `",
  "[INLINE_CODE_27]": "` dans la ligne de commande.\n- Pour interrompre un conteneur, saisissez `",
  "[INLINE_CODE_28]": "` dans la ligne de commande.\n- Pour redémarrer un conteneur, saisissez `",
  "[INLINE_CODE_29]": "` dans la ligne de commande.\n\n\n[SHORTCODE_3] **Astuce :** utilisez l'aide de Docker. Vous pouvez en savoir plus sur chaque commande au moyen de la commande *docker - -help*. Cette commande affiche toutes les commandes assorties d'une aide générale. Pour obtenir de l'aide sur une commande spécifique, vous pouvez aussi saisir *docker image - -help*.[SHORTCODE_4]\n\n\n### Gérer les conteneurs en fonctionnement\nPour obtenir une liste de tous les conteneurs en fonctionnement, exécutez la commande `",
  "[INLINE_CODE_30]": "`docker ps`",
  "[INLINE_CODE_31]": "`. Vous y trouverez un identifiant \"containerId\" qui pourra être utilisé dans d'autres commandes liées à ce conteneur.\n\nPour obtenir une liste de toutes les images locales, exécutez la commande `",
  "[INLINE_CODE_32]": "`docker images`",
  "[INLINE_CODE_33]": "`\n\nLes images peuvent devenir assez volumineuses. Pour libérer de l'espace, vous pouvez utiliser la commande `",
  "[INLINE_CODE_34]": "`docker image prune`",
  "[INLINE_CODE_35]": "`, qui supprime les images qui ne sont plus utilisées par des conteneurs actifs. Vous pouvez aussi utiliser la commande `",
  "[INLINE_CODE_36]": "`docker image rm <containerid>`",
  "[INLINE_CODE_37]": "` pour retirer un conteneur spécifique.\n\n### Retirer des objets Docker inutilisés\n\nLe [script d'installation d'Uptrends pour les emplacements privés]([LINK_URL_12]) ne prévoit pas de nettoyage automatique des objets Docker inutilisés. Pour retirer des objets Docker non utilisés, reportez-vous à la documentation sur le [nettoyage des objets Docker inutilisés]([LINK_URL_13]). Si vous utilisez d'autres plateformes, comme Kubernetes, veuillez vous reporter à leur documentation officielle.\n\n### Obtenir l'accès commande/shell à l'intérieur du conteneur\nExécutez cette commande pour démarrer un processus PowerShell ou un processus de commande depuis l'intérieur du conteneur. Cela vous permet d'accéder rapidement au système de fichiers depuis les conteneurs. Utilisez les commandes [CODE_BLOCK_1] ou [CODE_BLOCK_2].\n\nVous ne savez pas si vous êtes à l'intérieur ou à l'extérieur d'un conteneur ? Saisissez `",
  "[INLINE_CODE_38]": "`winver`",
  "[INLINE_CODE_39]": "` dans l'invite de commande de Windows. Si vous êtes à l'intérieur du conteneur, vous verrez ceci :\n\n[CODE_BLOCK_3]\n\nSi vous êtes sur l'hôte, la fenêtre contextuelle **About Windows** s'affichera.\nPour sortir du PowerShell ou de la session de commandes depuis le conteneur et revenir à l'hôte, utilisez la commande Ctrl+C.\n\n### Lire la sortie du fichier journal\n\n1. Ouvrez une console PowerShell en mode admin.\n2. Ouvrez le dossier où se trouve le fichier docker-compose.yml file et exécutez l'une des commandes suivantes.\n- Pour consulter la sortie du journal, saisissez `",
  "[INLINE_CODE_40]": "` dans la ligne de commande.\n- Pour envoyer cette sortie dans un fichier containerlogs.log, saisissez `",
  "[INLINE_CODE_41]": "`Docker-compose logs -t -n 5000 > containerlogs.log`",
  "[INLINE_CODE_42]": "`\n\n### Réseau\nAu démarrage, Docker crée un réseau virtuel sur l'hôte auquel les conteneurs sont associés, et obtient une adresse IP.\nVous pouvez afficher les réseaux existants dans PowerShell avec la commande `",
  "[INLINE_CODE_43]": "`docker network ls`",
  "[INLINE_CODE_44]": "` et un réseau spécifique avec la commande `",
  "[INLINE_CODE_45]": "`docker network inspect <<network name>>`",
  "[INLINE_CODE_46]": "`. Pour trouver le réseau associé à un conteneur, utilisez la commande `",
  "[INLINE_CODE_47]": "`docker inspect <<container name>>`",
  "[INLINE_CODE_48]": "` (et `",
  "[INLINE_CODE_49]": "`docker ps`",
  "[INLINE_CODE_50]": "` pour trouver les noms des conteneurs).\n\nLes trois conteneurs Docker d'Uptrends (Checkpoint, CheckpointRelay et TransactionProcessor) doivent pouvoir se connecter à Uptrends via les commandes probemaster1.uptrends.com et probemaster2.uptrends.com. Les conteneurs Checkpoint et CheckpointRelay doivent pouvoir se connecter aux applications clients testées.\n\n### Problèmes liés au DNS\n\nLes problèmes de connectivité sont souvent liés à la résolution DNS. Pour les résoudre, vous pouvez suivre ces étapes :\n\n1. Sur l'hôte, `",
  "[INLINE_CODE_51]": "`nslookup probemaster1.uptrends.com`",
  "[INLINE_CODE_52]": "` doit renvoyer 95.211.70.204. Si ce n'est pas le cas, les conteneurs ne pourront pas se connecter à Uptrends.\n\n2. Après avoir vérifié que les conteneurs fonctionnent (au moyen de la commande `",
  "[INLINE_CODE_53]": "`docker ps`",
  "[INLINE_CODE_54]": "`), ouvrez une session PowerShell dans un conteneur : `",
  "[INLINE_CODE_55]": "`docker exec -i Checkpoint powershell.exe`",
  "[INLINE_CODE_56]": "`.\n\n3. Une fois dans le conteneur, `",
  "[INLINE_CODE_57]": "`nslookup probemaster1.uptrends.com`",
  "[INLINE_CODE_58]": "` doit à nouveau renvoyer 95.211.70.204. Si c'est le cas, le conteneur doit pouvoir se connecter à la plateforme cloud d'Uptrends.\n\n4. Essayez la même manœuvre pour un nom d'hôte d'une application interne, comme `",
  "[INLINE_CODE_59]": "`nslookup <<name application>>`",
  "[INLINE_CODE_60]": "`, et vérifiez l'adresse IP renvoyée. Une fois le délai atteint, l'application n'est plus atteignable depuis le conteneur (et ne peut donc pas être surveillée).\n\nSi l'une de ces étapes échoue, vous pouvez essayer l'action suivante :\n\n- Comparez ipconfig depuis l'hôte et depuis l'intérieur d'un conteneur (`",
  "[INLINE_CODE_61]": "`docker exec -i Checkpoint powershell.exe`",
  "[INLINE_CODE_62]": "` pour obtenir une session PowerShell dans le conteneur de checkpoints) et vérifiez le ou les serveurs DNS configurés.\n\nEssayez de spécifier un DNS public comme 8.8.8.8 (Google) lors de l'exécution de la commande nslookup comme ceci : `",
  "[INLINE_CODE_63]": "`nslookup probemaster1.uptrends.com 8.8.8.8`"
}